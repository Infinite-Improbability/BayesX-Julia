<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Internals ¬∑ BayesJ</title><script data-outdated-warner src="../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.045/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.13.24/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL=".."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../assets/documenter.js"></script><script src="../siteinfo.js"></script><script src="../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit"><a href="../">BayesJ</a></span></div><form class="docs-search" action="../search/"><input class="docs-search-query" id="documenter-search-query" name="q" type="text" placeholder="Search docs"/></form><ul class="docs-menu"><li><a class="tocitem" href="../">Home</a></li><li><span class="tocitem">Reference</span><ul><li><a class="tocitem" href="../public/">Public</a></li><li class="is-active"><a class="tocitem" href>Internals</a><ul class="internal"><li><a class="tocitem" href="#Contents"><span>Contents</span></a></li><li><a class="tocitem" href="#Index"><span>Index</span></a></li><li><a class="tocitem" href="#Private-Interface"><span>Private Interface</span></a></li></ul></li></ul></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">Reference</a></li><li class="is-active"><a href>Internals</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Internals</a></li></ul></nav><div class="docs-right"><a class="docs-edit-link" href="https://github.com/Infinite-Improbability/BayesX-Julia/blob/main/docs/src/private.md" title="Edit on GitHub"><span class="docs-icon fab">ÔÇõ</span><span class="docs-label is-hidden-touch">Edit on GitHub</span></a><a class="docs-settings-button fas fa-cog" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-sidebar-button fa fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a></div></header><article class="content" id="documenter-page"><h1 id="Internals"><a class="docs-heading-anchor" href="#Internals">Internals</a><a id="Internals-1"></a><a class="docs-heading-anchor-permalink" href="#Internals" title="Permalink"></a></h1><h2 id="Contents"><a class="docs-heading-anchor" href="#Contents">Contents</a><a id="Contents-1"></a><a class="docs-heading-anchor-permalink" href="#Contents" title="Permalink"></a></h2><ul><li><a href="#Internals">Internals</a></li><li class="no-marker"><ul><li><a href="#Contents">Contents</a></li><li><a href="#Index">Index</a></li><li><a href="#Private-Interface">Private Interface</a></li><li class="no-marker"><ul><li><a href="#Cluster-Models">Cluster Models</a></li><li><a href="#Constants">Constants</a></li><li><a href="#Emissions-Modelling">Emissions Modelling</a></li><li><a href="#IO">IO</a></li><li><a href="#Likelihood">Likelihood</a></li><li><a href="#Utilities">Utilities</a></li></ul></li></ul></li></ul><h2 id="Index"><a class="docs-heading-anchor" href="#Index">Index</a><a id="Index-1"></a><a class="docs-heading-anchor-permalink" href="#Index" title="Permalink"></a></h2><ul><li><a href="#BayesJ.cosmo"><code>BayesJ.cosmo</code></a></li><li><a href="#BayesJ.Œº"><code>BayesJ.Œº</code></a></li><li><a href="#BayesJ.Œº_e"><code>BayesJ.Œº_e</code></a></li><li><a href="#BayesJ.Dataset"><code>BayesJ.Dataset</code></a></li><li><a href="#BayesJ.Prior"><code>BayesJ.Prior</code></a></li><li><a href="#BayesJ.XS_Mekal"><code>BayesJ.XS_Mekal</code></a></li><li><a href="#BayesJ.Model_NFW_GNFW-Union{Tuple{T}, Tuple{N}, Tuple{T, T, T, T, T, T, T, Vector{N}, Union{Unitful.Quantity{T, ùêÄ, U}, Unitful.Level{L, S, Unitful.Quantity{T, ùêÄ, U}} where {L, S}} where U, Any, Union{Unitful.Quantity{T, ùêì, U}, Unitful.Level{L, S, Unitful.Quantity{T, ùêì, U}} where {L, S}} where U, Matrix, Any}} where {N&lt;:Integer, T&lt;:AbstractFloat}"><code>BayesJ.Model_NFW_GNFW</code></a></li><li><a href="#BayesJ.apply_response_function-Union{Tuple{T}, Tuple{Vector{T}, Matrix{T}, T}} where T&lt;:AbstractFloat"><code>BayesJ.apply_response_function</code></a></li><li><a href="#BayesJ.bin_events-Tuple{PlaintextData, Any, Vararg{Any}}"><code>BayesJ.bin_events</code></a></li><li><a href="#BayesJ.bin_events-Tuple{FITSData, Vararg{Any, 4}}"><code>BayesJ.bin_events</code></a></li><li><a href="#BayesJ.call_mekal-Tuple{Any, Any, Any}"><code>BayesJ.call_mekal</code></a></li><li><a href="#BayesJ.load_data-Tuple{BayesJ.Dataset}"><code>BayesJ.load_data</code></a></li><li><a href="#BayesJ.load_data-Tuple{PlaintextData}"><code>BayesJ.load_data</code></a></li><li><a href="#BayesJ.load_data-Tuple{FITSData}"><code>BayesJ.load_data</code></a></li><li><a href="#BayesJ.load_events_from_fits-Tuple{AbstractString}"><code>BayesJ.load_events_from_fits</code></a></li><li><a href="#BayesJ.load_response-Tuple{BayesJ.Dataset, Any}"><code>BayesJ.load_response</code></a></li><li><a href="#BayesJ.load_response-Tuple{PlaintextData, Any}"><code>BayesJ.load_response</code></a></li><li><a href="#BayesJ.log_factorial-Tuple{N} where N&lt;:Integer"><code>BayesJ.log_factorial</code></a></li><li><a href="#BayesJ.log_likelihood-NTuple{5, Any}"><code>BayesJ.log_likelihood</code></a></li><li><a href="#BayesJ.make_cube_transform-Tuple{Vararg{BayesJ.Prior}}"><code>BayesJ.make_cube_transform</code></a></li><li><a href="#BayesJ.prepare_model_mekal-Union{Tuple{V}, Tuple{U}, Tuple{T}, Tuple{Union{Unitful.Quantity{T, ùêã^-2, U}, Unitful.Level{L, S, Unitful.Quantity{T, ùêã^-2, U}} where {L, S}} where {T, U}, AbstractRange{T}, Real}} where {T&lt;:(Union{Unitful.Quantity{T, ùêã^2 ùêå ùêì^-2, U}, Unitful.Level{L, S, Unitful.Quantity{T, ùêã^2 ùêå ùêì^-2, U}} where {L, S}} where {T, U}), U&lt;:(Union{Unitful.Quantity{T, ùêã^2 ùêå ùêì^-2, U}, Unitful.Level{L, S, Unitful.Quantity{T, ùêã^2 ùêå ùêì^-2, U}} where {L, S}} where {T, U}), V&lt;:(Union{Unitful.Quantity{T, ùêã^-3, U}, Unitful.Level{L, S, Unitful.Quantity{T, ùêã^-3, U}} where {L, S}} where {T, U})}"><code>BayesJ.prepare_model_mekal</code></a></li><li><a href="#BayesJ.surface_brightness-Tuple{Union{Unitful.Quantity{T, ùêã, U}, Unitful.Level{L, S, Unitful.Quantity{T, ùêã, U}} where {L, S}} where {T, U}, Function, Function, Float64, Union{Unitful.Quantity{T, ùêã, U}, Unitful.Level{L, S, Unitful.Quantity{T, ùêã, U}} where {L, S}} where {T, U}, Any, Union{Unitful.Quantity{T, ùêÄ, U}, Unitful.Level{L, S, Unitful.Quantity{T, ùêÄ, U}} where {L, S}} where {T, U}}"><code>BayesJ.surface_brightness</code></a></li><li><a href="#BayesJ.transform-Tuple{BayesJ.Prior, Real}"><code>BayesJ.transform</code></a></li><li><a href="#BayesJ.œÅ_crit-Tuple{Any}"><code>BayesJ.œÅ_crit</code></a></li></ul><h2 id="Private-Interface"><a class="docs-heading-anchor" href="#Private-Interface">Private Interface</a><a id="Private-Interface-1"></a><a class="docs-heading-anchor-permalink" href="#Private-Interface" title="Permalink"></a></h2><h3 id="Cluster-Models"><a class="docs-heading-anchor" href="#Cluster-Models">Cluster Models</a><a id="Cluster-Models-1"></a><a class="docs-heading-anchor-permalink" href="#Cluster-Models" title="Permalink"></a></h3><article class="docstring"><header><a class="docstring-binding" id="BayesJ.Model_NFW_GNFW-Union{Tuple{T}, Tuple{N}, Tuple{T, T, T, T, T, T, T, Vector{N}, Union{Unitful.Quantity{T, ùêÄ, U}, Unitful.Level{L, S, Unitful.Quantity{T, ùêÄ, U}} where {L, S}} where U, Any, Union{Unitful.Quantity{T, ùêì, U}, Unitful.Level{L, S, Unitful.Quantity{T, ùêì, U}} where {L, S}} where U, Matrix, Any}} where {N&lt;:Integer, T&lt;:AbstractFloat}" href="#BayesJ.Model_NFW_GNFW-Union{Tuple{T}, Tuple{N}, Tuple{T, T, T, T, T, T, T, Vector{N}, Union{Unitful.Quantity{T, ùêÄ, U}, Unitful.Level{L, S, Unitful.Quantity{T, ùêÄ, U}} where {L, S}} where U, Any, Union{Unitful.Quantity{T, ùêì, U}, Unitful.Level{L, S, Unitful.Quantity{T, ùêì, U}} where {L, S}} where U, Matrix, Any}} where {N&lt;:Integer, T&lt;:AbstractFloat}"><code>BayesJ.Model_NFW_GNFW</code></a> ‚Äî <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">Model_NFW_GNFW_GNFW(MT_200, fg_200, Œ±, Œ≤, Œ≥, c_500_GNFW, z, shape, pixel_edge_angle, emission_model, exposure_time, response_function)</code></pre><p>Calculate predicted counts using a physical model based NFW-GNFW profiles as described in Olamaie 2012.</p><p>The first six parameters are model priors.  <code>z</code> is redshift and <code>shape</code> describes the size of the source number as a number of spatial bins in each dimension. The pixel edge angle describes the angular size observed by a single pixel in units such as arcseconds. This area is assumed to be square with the edge angle giving the side length. The emission model should be a function compatible with the requirements of the <code>surface_brightness</code> function, which it will be passed to. The response function includes both the RMF and ARF, as described in <code>apply_response_function</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/Infinite-Improbability/BayesX-Julia/blob/92db5f75ce6258ceebbe7567b38382133ad2c1cc/src/gas_models.jl#L20-L31">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="BayesJ.œÅ_crit-Tuple{Any}" href="#BayesJ.œÅ_crit-Tuple{Any}"><code>BayesJ.œÅ_crit</code></a> ‚Äî <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">p_crit(z)</code></pre><p>Calculate the critical density at some redshift <code>z</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/Infinite-Improbability/BayesX-Julia/blob/92db5f75ce6258ceebbe7567b38382133ad2c1cc/src/gas_models.jl#L12-L16">source</a></section></article><h3 id="Constants"><a class="docs-heading-anchor" href="#Constants">Constants</a><a id="Constants-1"></a><a class="docs-heading-anchor-permalink" href="#Constants" title="Permalink"></a></h3><article class="docstring"><header><a class="docstring-binding" id="BayesJ.cosmo" href="#BayesJ.cosmo"><code>BayesJ.cosmo</code></a> ‚Äî <span class="docstring-category">Constant</span></header><section><div><p>Cosmology assumed by BayesX</p><p>Defaults to:</p><ul><li>h=0.69,</li><li>Neff=3.04,</li><li>OmegaK=0,</li><li>OmegaM=0.29,</li><li>OmegaR=nothing,</li><li>Tcmb=2.7255,</li><li>w0=-1,</li><li>wa=0</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/Infinite-Improbability/BayesX-Julia/blob/92db5f75ce6258ceebbe7567b38382133ad2c1cc/src/params.jl#L5-L17">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="BayesJ.Œº" href="#BayesJ.Œº"><code>BayesJ.Œº</code></a> ‚Äî <span class="docstring-category">Constant</span></header><section><div><p>Mean mass per gas particle = 0.6m‚Çö</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/Infinite-Improbability/BayesX-Julia/blob/92db5f75ce6258ceebbe7567b38382133ad2c1cc/src/params.jl#L27">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="BayesJ.Œº_e" href="#BayesJ.Œº_e"><code>BayesJ.Œº_e</code></a> ‚Äî <span class="docstring-category">Constant</span></header><section><div><p>Mean gas mass per electron = 1.14m‚Çö</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/Infinite-Improbability/BayesX-Julia/blob/92db5f75ce6258ceebbe7567b38382133ad2c1cc/src/params.jl#L30">source</a></section></article><h3 id="Emissions-Modelling"><a class="docs-heading-anchor" href="#Emissions-Modelling">Emissions Modelling</a><a id="Emissions-Modelling-1"></a><a class="docs-heading-anchor-permalink" href="#Emissions-Modelling" title="Permalink"></a></h3><article class="docstring"><header><a class="docstring-binding" id="BayesJ.apply_response_function-Union{Tuple{T}, Tuple{Vector{T}, Matrix{T}, T}} where T&lt;:AbstractFloat" href="#BayesJ.apply_response_function-Union{Tuple{T}, Tuple{Vector{T}, Matrix{T}, T}} where T&lt;:AbstractFloat"><code>BayesJ.apply_response_function</code></a> ‚Äî <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">apply_response_function(counts_per_bin::Vector, response::Matrix, exposure_time::Unitful.Time)::Vector{Float64}</code></pre><p>Applies the response function <span>$RSP(PI, E) = RMF(PI, E) ‚àò ARF(E)$</span> to all energy bins and returns adjusted counts per bin.</p><p class="math-container">\[\begin{aligned}
C(PI) &amp;= T \int RMF(PI, E) ‚ãÖ ARF(E) ‚ãÖ S(E) ‚ãÖ dE \\
&amp;‚âà T \sum_{j} R_{ij} A{j} S{j}
\end{aligned}\]</p><p>with <code>C(PI)</code> is the observed counts in a detector channel <code>PI</code>, <code>T</code> is the observation time, <code>ARF(E)</code> is the effective area of the instrument and <code>RMF(E, PI)</code> is the unitless response matrix. (Handbook of X-ray Astronomy Chapter 2011, Chapter 5 pg 87, by K. Arnaud, R. Smith and A. Siemiginowska)</p><p>This function takes the combined RMF and ARF as the response function. This is to recalculating it on every call. Some people format the RMF as RMF(PI, E). This convention is used by CIAO, for example.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/Infinite-Improbability/BayesX-Julia/blob/92db5f75ce6258ceebbe7567b38382133ad2c1cc/src/emission.jl#L82-L98">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="BayesJ.surface_brightness-Tuple{Union{Unitful.Quantity{T, ùêã, U}, Unitful.Level{L, S, Unitful.Quantity{T, ùêã, U}} where {L, S}} where {T, U}, Function, Function, Float64, Union{Unitful.Quantity{T, ùêã, U}, Unitful.Level{L, S, Unitful.Quantity{T, ùêã, U}} where {L, S}} where {T, U}, Any, Union{Unitful.Quantity{T, ùêÄ, U}, Unitful.Level{L, S, Unitful.Quantity{T, ùêÄ, U}} where {L, S}} where {T, U}}" href="#BayesJ.surface_brightness-Tuple{Union{Unitful.Quantity{T, ùêã, U}, Unitful.Level{L, S, Unitful.Quantity{T, ùêã, U}} where {L, S}} where {T, U}, Function, Function, Float64, Union{Unitful.Quantity{T, ùêã, U}, Unitful.Level{L, S, Unitful.Quantity{T, ùêã, U}} where {L, S}} where {T, U}, Any, Union{Unitful.Quantity{T, ùêÄ, U}, Unitful.Level{L, S, Unitful.Quantity{T, ùêÄ, U}} where {L, S}} where {T, U}}"><code>BayesJ.surface_brightness</code></a> ‚Äî <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">surface_brightness(projected_radius, temperature, density, z, limit, model, pixel_edge_length)</code></pre><p>Calculate the observed surface_brightness at some projected radius on the sky.</p><p>The temperature and density functions should take the true distance from origin (cluster centre) and return the appropriate value, with units. The limit controls limits on LOS radius during integration. Theoretically it should be ¬±infinity, but we may approximate it as a finite value. The pixel edge length is the distance observed on the sky, determined from the pixel<em>edge</em>angle at source redshift.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/Infinite-Improbability/BayesX-Julia/blob/92db5f75ce6258ceebbe7567b38382133ad2c1cc/src/emission.jl#L7-L15">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="BayesJ.XS_Mekal" href="#BayesJ.XS_Mekal"><code>BayesJ.XS_Mekal</code></a> ‚Äî <span class="docstring-category">Type</span></header><section><div><p>Mekal model using SpectralFitting.jl framework. Kept around so we can borrow the model data downloading functions.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/Infinite-Improbability/BayesX-Julia/blob/92db5f75ce6258ceebbe7567b38382133ad2c1cc/src/mekal.jl#L12">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="BayesJ.call_mekal-Tuple{Any, Any, Any}" href="#BayesJ.call_mekal-Tuple{Any, Any, Any}"><code>BayesJ.call_mekal</code></a> ‚Äî <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">call_mekal(energy_range, temperature, nH)</code></pre><p>Given a unitful range of energy and unitless temperature (keV) and hydrogen density in the source (cm^-3) calls MEKAL to calculate the volume emissivity of the source in the source frame.</p><p>Due to performance concerns I recommend calling <code>prepare_model_mekal</code> instead to generate an interpolation over the model. The interpolation also implicitly includes absorption, which this function does not.</p><p><strong>Implementation Details</strong></p><p>The XSPEC and MEKAL documentation is at times short on detail. Here&#39;s what I&#39;ve figured out, mostly by inspecting the models in the XSPEC source code. The MEKA model has similar code and more extensive comments that MEKAL  that are very helpful.</p><p>The values calculated by MEKAL are multiplied by a constant of 2.53325e-3. Inspecting the MEKA comments we find the following equation for this constant which we will term <code>C</code></p><p class="math-container">\[C = ‚àö2 ‚ãÖ h^2 ‚ãÖ Œ±^3 / ((3œÄm_e)^1.5 ‚ãÖ ‚àö(1000e) ‚ãÖ œÄ ‚ãÖ (1pc)^2 ‚ãÖ 10^4)\]</p><p>and the instruction to use SI units. <code>h</code> appears to be Planck&#39;s constant (unreduced) and <code>Œ±</code> the fine-structure constant. Calculating this gives C=2.533242122484874e-59 kg^1/2 m^2 A^-1/2 s^-5/2.</p><p>MEKAL adjusts emissions by what it terms <code>cem</code> which is the emitting volume divided by the square of distance to the volume. This follows naturally from the relationship between surface emissivity <code>œÉ</code> and volume emissivity <code>œµ</code>.</p><p class="math-container">\[    œÉ = œµV / (4œÄD)^2\]</p><p>MEKAL uses units of 1e50cm^3 / 1pc^2 for <code>cem</code>. If we multiply by 10^50cm^3 we get 2.533242122484874e-13 J^2 cm s^2 C^-1/2 kg^-3/2. As dividing by 1pc^2 would change more than just the magnitude of the value I assume it is folded in as the 1pc^2 in the original equation. Furthermore I assume that remaining difference rests in the details of units and implementation.</p><p>MEKAL states it outputs in phot/cm^2/s/keV. MEKA states the same but has an optional switch that instead outputs in phot/m^3/s/keV. It does this by replacing <code>C</code> with <code>D=3.03103E-9</code> which it states is derived so that</p><p class="math-container">\[C = D * 10^40 / (4œÄ * 1pc^2)\]</p><p>I have verified this gives results matching that of doing the conversion manually (by dividing out 1e50cm^3 and multiplying by 1pc^2).</p><p>Attempts were made to invoke MEKAL through XSPEC&#39;s wrapper functions but I found the modifications they introduced were troublesome to work out, though some were necessary and are reimplemented in <code>surface_brightness</code>. MEKAL&#39;s operations are more clearly physically motivated.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/Infinite-Improbability/BayesX-Julia/blob/92db5f75ce6258ceebbe7567b38382133ad2c1cc/src/mekal.jl#L42-L83">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="BayesJ.prepare_model_mekal-Union{Tuple{V}, Tuple{U}, Tuple{T}, Tuple{Union{Unitful.Quantity{T, ùêã^-2, U}, Unitful.Level{L, S, Unitful.Quantity{T, ùêã^-2, U}} where {L, S}} where {T, U}, AbstractRange{T}, Real}} where {T&lt;:(Union{Unitful.Quantity{T, ùêã^2 ùêå ùêì^-2, U}, Unitful.Level{L, S, Unitful.Quantity{T, ùêã^2 ùêå ùêì^-2, U}} where {L, S}} where {T, U}), U&lt;:(Union{Unitful.Quantity{T, ùêã^2 ùêå ùêì^-2, U}, Unitful.Level{L, S, Unitful.Quantity{T, ùêã^2 ùêå ùêì^-2, U}} where {L, S}} where {T, U}), V&lt;:(Union{Unitful.Quantity{T, ùêã^-3, U}, Unitful.Level{L, S, Unitful.Quantity{T, ùêã^-3, U}} where {L, S}} where {T, U})}" href="#BayesJ.prepare_model_mekal-Union{Tuple{V}, Tuple{U}, Tuple{T}, Tuple{Union{Unitful.Quantity{T, ùêã^-2, U}, Unitful.Level{L, S, Unitful.Quantity{T, ùêã^-2, U}} where {L, S}} where {T, U}, AbstractRange{T}, Real}} where {T&lt;:(Union{Unitful.Quantity{T, ùêã^2 ùêå ùêì^-2, U}, Unitful.Level{L, S, Unitful.Quantity{T, ùêã^2 ùêå ùêì^-2, U}} where {L, S}} where {T, U}), U&lt;:(Union{Unitful.Quantity{T, ùêã^2 ùêå ùêì^-2, U}, Unitful.Level{L, S, Unitful.Quantity{T, ùêã^2 ùêå ùêì^-2, U}} where {L, S}} where {T, U}), V&lt;:(Union{Unitful.Quantity{T, ùêã^-3, U}, Unitful.Level{L, S, Unitful.Quantity{T, ùêã^-3, U}} where {L, S}} where {T, U})}"><code>BayesJ.prepare_model_mekal</code></a> ‚Äî <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">prepare_model_mekal(nHcol, energy_bins, z; temperatures, hydrogen_densities)</code></pre><p>Create an interpolated alias to the mekal model with photoelectric absorption over specified parameter ranges.</p><p>The interpolation object <code>(T::Unitful.Energy, nH::Unitful.ùêã^-3) -&gt; volume emissivity</code> returned gives the volume emissivity per bin of a source of the specified temperature and hydrogen number density with the effects of absorption from passage through an area with a hydrogen column density equal to that specified in the <code>prepare_model_mekal</code> call.</p><p>Applies redshift and time dilation.</p><p>Interpolation has a significant performance improvement over calling the model directly. No redshift is currently applied to energy bins - they should be assumed to be in the source frame. It may be wise to adjust this but then <code>surface_brightness</code> will need adjustment so it doesn&#39;t apply the correction twice.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/Infinite-Improbability/BayesX-Julia/blob/92db5f75ce6258ceebbe7567b38382133ad2c1cc/src/mekal.jl#L145-L160">source</a></section></article><h3 id="IO"><a class="docs-heading-anchor" href="#IO">IO</a><a id="IO-1"></a><a class="docs-heading-anchor-permalink" href="#IO" title="Permalink"></a></h3><article class="docstring"><header><a class="docstring-binding" id="BayesJ.Dataset" href="#BayesJ.Dataset"><code>BayesJ.Dataset</code></a> ‚Äî <span class="docstring-category">Type</span></header><section><div><p>Abstract type to wrap various specific formats for source data. By doing so we can make use of     multiple dispatch to automatically select the appropriate loading functions for data.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/Infinite-Improbability/BayesX-Julia/blob/92db5f75ce6258ceebbe7567b38382133ad2c1cc/src/io.jl#L11-L14">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="BayesJ.bin_events-Tuple{FITSData, Vararg{Any, 4}}" href="#BayesJ.bin_events-Tuple{FITSData, Vararg{Any, 4}}"><code>BayesJ.bin_events</code></a> ‚Äî <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">bin_events(::FITSData, events, energy_range, x_edges, y_edges)</code></pre><p>Take a table of events in the format (x y channel energy), trim it by energy and bin it spatially. Returns an array of counts per bin with dimensions (channel, x, y).</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/Infinite-Improbability/BayesX-Julia/blob/92db5f75ce6258ceebbe7567b38382133ad2c1cc/src/io.jl#L151-L156">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="BayesJ.bin_events-Tuple{PlaintextData, Any, Vararg{Any}}" href="#BayesJ.bin_events-Tuple{PlaintextData, Any, Vararg{Any}}"><code>BayesJ.bin_events</code></a> ‚Äî <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">bin_events(::PlaintextData, events, ...)</code></pre><p>Placeholder function, returns events matrix without modification</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/Infinite-Improbability/BayesX-Julia/blob/92db5f75ce6258ceebbe7567b38382133ad2c1cc/src/io.jl#L230-L233">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="BayesJ.load_data-Tuple{BayesJ.Dataset}" href="#BayesJ.load_data-Tuple{BayesJ.Dataset}"><code>BayesJ.load_data</code></a> ‚Äî <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">load_data(data)</code></pre><p>Load events data from a given dataset, returning pairs of events and exposure times.</p><p>The first pair includes all observed events, the second is the background observation.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/Infinite-Improbability/BayesX-Julia/blob/92db5f75ce6258ceebbe7567b38382133ad2c1cc/src/io.jl#L31-L37">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="BayesJ.load_data-Tuple{FITSData}" href="#BayesJ.load_data-Tuple{FITSData}"><code>BayesJ.load_data</code></a> ‚Äî <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">load_data(data::FITSData)</code></pre><p>Load data from FITS events files for the observation and background.</p><p>Exposure times are taken from the LIVETIME value in the header.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/Infinite-Improbability/BayesX-Julia/blob/92db5f75ce6258ceebbe7567b38382133ad2c1cc/src/io.jl#L83-L89">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="BayesJ.load_data-Tuple{PlaintextData}" href="#BayesJ.load_data-Tuple{PlaintextData}"><code>BayesJ.load_data</code></a> ‚Äî <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">load_data(data::PlaintextData)</code></pre><p>Load data from plaintext files as generated by existing Bayes-X binning scripts.</p><p>Data is reshaped to the given size so should be provided in column-major order or in a matrix of correct size.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/Infinite-Improbability/BayesX-Julia/blob/92db5f75ce6258ceebbe7567b38382133ad2c1cc/src/io.jl#L197-L204">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="BayesJ.load_events_from_fits-Tuple{AbstractString}" href="#BayesJ.load_events_from_fits-Tuple{AbstractString}"><code>BayesJ.load_events_from_fits</code></a> ‚Äî <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">load_events_from_fits(path)</code></pre><p>Loads events from a single fits file for further processing.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/Infinite-Improbability/BayesX-Julia/blob/92db5f75ce6258ceebbe7567b38382133ad2c1cc/src/io.jl#L61-L65">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="BayesJ.load_response-Tuple{BayesJ.Dataset, Any}" href="#BayesJ.load_response-Tuple{BayesJ.Dataset, Any}"><code>BayesJ.load_response</code></a> ‚Äî <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">load_response(data, energy_range)</code></pre><p>Load the RMF and ARF for an observation, trimmed for the desired energy range</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/Infinite-Improbability/BayesX-Julia/blob/92db5f75ce6258ceebbe7567b38382133ad2c1cc/src/io.jl#L42-L46">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="BayesJ.load_response-Tuple{PlaintextData, Any}" href="#BayesJ.load_response-Tuple{PlaintextData, Any}"><code>BayesJ.load_response</code></a> ‚Äî <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">load_response(data::PlaintextData, _)</code></pre><p>Load response matrix from plaintext files as generated by existing Bayes-X binning scripts.</p><p>Data is reshaped to the given size so should be provided in column-major order or as a matrix of correct size.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/Infinite-Improbability/BayesX-Julia/blob/92db5f75ce6258ceebbe7567b38382133ad2c1cc/src/io.jl#L211-L218">source</a></section></article><h3 id="Likelihood"><a class="docs-heading-anchor" href="#Likelihood">Likelihood</a><a id="Likelihood-1"></a><a class="docs-heading-anchor-permalink" href="#Likelihood" title="Permalink"></a></h3><article class="docstring"><header><a class="docstring-binding" id="BayesJ.Prior" href="#BayesJ.Prior"><code>BayesJ.Prior</code></a> ‚Äî <span class="docstring-category">Type</span></header><section><div><p>Abstract supertype for priors. Should implement a transform(prior, x) function that Transforms a value x on the unit range to a value on the distribution represented by the prior.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/Infinite-Improbability/BayesX-Julia/blob/92db5f75ce6258ceebbe7567b38382133ad2c1cc/src/likelihood.jl#L58-L61">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="BayesJ.log_factorial-Tuple{N} where N&lt;:Integer" href="#BayesJ.log_factorial-Tuple{N} where N&lt;:Integer"><code>BayesJ.log_factorial</code></a> ‚Äî <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">log_factorial(n)</code></pre><p>Finds the natural logarithm of the factorial of <code>n</code>.</p><p><code>n</code> rapidly gets to large to quickly and directly calculate the factorial so we exploit logarithm rules to expand it out to a series of sums.</p><p>It is intended to be broadcast across all values of the data array.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/Infinite-Improbability/BayesX-Julia/blob/92db5f75ce6258ceebbe7567b38382133ad2c1cc/src/likelihood.jl#L46-L55">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="BayesJ.log_likelihood-NTuple{5, Any}" href="#BayesJ.log_likelihood-NTuple{5, Any}"><code>BayesJ.log_likelihood</code></a> ‚Äî <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">log_likelihood(observed, observed_background, predicted, predicted_background, observed_log_factorial)</code></pre><p>Calculate the log-likelihood of the prediction given an observation.</p><p>The observed and predicted arrays include background events. Log factorial is calculated as <code>ln(observed) + ln(observed_background)</code>. We require it to be supplied to improve performance - no need to calculate it every time.</p><p>We assume the predicted_background is scaled to the same exposure time as the observed background.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/Infinite-Improbability/BayesX-Julia/blob/92db5f75ce6258ceebbe7567b38382133ad2c1cc/src/likelihood.jl#L3-L13">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="BayesJ.make_cube_transform-Tuple{Vararg{BayesJ.Prior}}" href="#BayesJ.make_cube_transform-Tuple{Vararg{BayesJ.Prior}}"><code>BayesJ.make_cube_transform</code></a> ‚Äî <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">make_cube_transform(priors::Prior...)</code></pre><p>Turn a sequence of prior transform functions intoNorma a transform function that operates on the hypercube generated by multinest.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/Infinite-Improbability/BayesX-Julia/blob/92db5f75ce6258ceebbe7567b38382133ad2c1cc/src/likelihood.jl#L103-L108">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="BayesJ.transform-Tuple{BayesJ.Prior, Real}" href="#BayesJ.transform-Tuple{BayesJ.Prior, Real}"><code>BayesJ.transform</code></a> ‚Äî <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">transform(prior, x)</code></pre><p>Transforms a value x on the unit range to a value on the distribution represented by the prior.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/Infinite-Improbability/BayesX-Julia/blob/92db5f75ce6258ceebbe7567b38382133ad2c1cc/src/likelihood.jl#L64-L68">source</a></section></article><h3 id="Utilities"><a class="docs-heading-anchor" href="#Utilities">Utilities</a><a id="Utilities-1"></a><a class="docs-heading-anchor-permalink" href="#Utilities" title="Permalink"></a></h3></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../public/">¬´ Public</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 0.27.25 on <span class="colophon-date" title="Saturday 5 August 2023 01:29">Saturday 5 August 2023</span>. Using Julia version 1.9.2.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
