<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Internals ¬∑ BayesJ</title><meta name="title" content="Internals ¬∑ BayesJ"/><meta property="og:title" content="Internals ¬∑ BayesJ"/><meta property="twitter:title" content="Internals ¬∑ BayesJ"/><meta name="description" content="Documentation for BayesJ."/><meta property="og:description" content="Documentation for BayesJ."/><meta property="twitter:description" content="Documentation for BayesJ."/><script data-outdated-warner src="../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL=".."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../assets/documenter.js"></script><script src="../search_index.js"></script><script src="../siteinfo.js"></script><script src="../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit"><a href="../">BayesJ</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../">Home</a></li><li><a class="tocitem" href="../setup/">Setup</a></li><li><a class="tocitem" href="../usage/">Usage</a></li><li><a class="tocitem" href="../models/">Cluster Models</a></li><li><span class="tocitem">API</span><ul><li><a class="tocitem" href="../public/">Public</a></li><li class="is-active"><a class="tocitem" href>Internals</a><ul class="internal"><li><a class="tocitem" href="#Index"><span>Index</span></a></li><li><a class="tocitem" href="#Private-Interface"><span>Private Interface</span></a></li></ul></li></ul></li><li><a class="tocitem" href="../references/">References</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">API</a></li><li class="is-active"><a href>Internals</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Internals</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/Infinite-Improbability/BayesX-Julia" title="View the repository on GitHub"><span class="docs-icon fa-brands">ÔÇõ</span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/Infinite-Improbability/BayesX-Julia/blob/main/docs/src/private.md" title="Edit source on GitHub"><span class="docs-icon fa-solid">ÔÅÑ</span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="Internals"><a class="docs-heading-anchor" href="#Internals">Internals</a><a id="Internals-1"></a><a class="docs-heading-anchor-permalink" href="#Internals" title="Permalink"></a></h1><h2 id="Index"><a class="docs-heading-anchor" href="#Index">Index</a><a id="Index-1"></a><a class="docs-heading-anchor-permalink" href="#Index" title="Permalink"></a></h2><ul><li><a href="#BayesJ.cosmo"><code>BayesJ.cosmo</code></a></li><li><a href="#BayesJ.Œº"><code>BayesJ.Œº</code></a></li><li><a href="#BayesJ.Œº_e"><code>BayesJ.Œº_e</code></a></li><li><a href="#BayesJ.Dataset"><code>BayesJ.Dataset</code></a></li><li><a href="#BayesJ.Ellipse"><code>BayesJ.Ellipse</code></a></li><li><a href="#BayesJ.LinearInterpolator"><code>BayesJ.LinearInterpolator</code></a></li><li><a href="#BayesJ.ObservationError"><code>BayesJ.ObservationError</code></a></li><li><a href="#BayesJ.Prior"><code>BayesJ.Prior</code></a></li><li><a href="#BayesJ.XS_Mekal"><code>BayesJ.XS_Mekal</code></a></li><li><a href="#BayesJ.apply_response_function-Union{Tuple{T}, Tuple{Vector{T}, Matrix{T}, T}} where T&lt;:AbstractFloat"><code>BayesJ.apply_response_function</code></a></li><li><a href="#BayesJ.bin_events-Tuple{PlaintextData, Any, Vararg{Any}}"><code>BayesJ.bin_events</code></a></li><li><a href="#BayesJ.bin_events-Tuple{FITSData, Any, Tuple{var&quot;#s1362&quot;, var&quot;#s1362&quot;} where var&quot;#s1362&quot;&lt;:Integer, Any, Any}"><code>BayesJ.bin_events</code></a></li><li><a href="#BayesJ.bin_events-Tuple{BayesJ.Dataset, Any, Vararg{Any}}"><code>BayesJ.bin_events</code></a></li><li><a href="#BayesJ.call_mekal-Union{Tuple{V}, Tuple{Vector{Float32}, Vector{Float32}, Integer, V, V, V, Float32, Float32}} where V&lt;:AbstractVector{Float32}"><code>BayesJ.call_mekal</code></a></li><li><a href="#BayesJ.cluster"><code>BayesJ.cluster</code></a></li><li><a href="#BayesJ.find_blobs_2D-Union{Tuple{T}, Tuple{AbstractMatrix{T}, T, Any, Any}} where T"><code>BayesJ.find_blobs_2D</code></a></li><li><a href="#BayesJ.fit_ellipse-Tuple{Matrix}"><code>BayesJ.fit_ellipse</code></a></li><li><a href="#BayesJ.getellipsepoints-Tuple{BayesJ.Ellipse}"><code>BayesJ.getellipsepoints</code></a></li><li><a href="#BayesJ.load_data-Tuple{FITSData}"><code>BayesJ.load_data</code></a></li><li><a href="#BayesJ.load_data-Tuple{PlaintextData}"><code>BayesJ.load_data</code></a></li><li><a href="#BayesJ.load_data-Tuple{BayesJ.Dataset}"><code>BayesJ.load_data</code></a></li><li><a href="#BayesJ.load_events_from_fits-Tuple{AbstractString}"><code>BayesJ.load_events_from_fits</code></a></li><li><a href="#BayesJ.load_mask-Tuple{AbstractString, Any, Any}"><code>BayesJ.load_mask</code></a></li><li><a href="#BayesJ.load_mask-Tuple{BayesJ.Dataset}"><code>BayesJ.load_mask</code></a></li><li><a href="#BayesJ.load_response-Tuple{FITSData, Union{Unitful.Quantity{T, ùêã^2 ùêå ùêì^-2, U}, Unitful.Level{L, S, Unitful.Quantity{T, ùêã^2 ùêå ùêì^-2, U}} where {L, S}} where {T, U}, Union{Unitful.Quantity{T, ùêã^2 ùêå ùêì^-2, U}, Unitful.Level{L, S, Unitful.Quantity{T, ùêã^2 ùêå ùêì^-2, U}} where {L, S}} where {T, U}}"><code>BayesJ.load_response</code></a></li><li><a href="#BayesJ.load_response-Tuple{PlaintextData, Union{Unitful.Quantity{T, ùêã^2 ùêå ùêì^-2, U}, Unitful.Level{L, S, Unitful.Quantity{T, ùêã^2 ùêå ùêì^-2, U}} where {L, S}} where {T, U}, Union{Unitful.Quantity{T, ùêã^2 ùêå ùêì^-2, U}, Unitful.Level{L, S, Unitful.Quantity{T, ùêã^2 ùêå ùêì^-2, U}} where {L, S}} where {T, U}}"><code>BayesJ.load_response</code></a></li><li><a href="#BayesJ.load_response-Tuple{BayesJ.Dataset, Union{Unitful.Quantity{T, ùêã^2 ùêå ùêì^-2, U}, Unitful.Level{L, S, Unitful.Quantity{T, ùêã^2 ùêå ùêì^-2, U}} where {L, S}} where {T, U}, Union{Unitful.Quantity{T, ùêã^2 ùêå ùêì^-2, U}, Unitful.Level{L, S, Unitful.Quantity{T, ùêã^2 ùêå ùêì^-2, U}} where {L, S}} where {T, U}}"><code>BayesJ.load_response</code></a></li><li><a href="#BayesJ.log_factorial-Tuple{N} where N&lt;:Integer"><code>BayesJ.log_factorial</code></a></li><li><a href="#BayesJ.log_likelihood-Tuple{Any, Any, Any}"><code>BayesJ.log_likelihood</code></a></li><li><a href="#BayesJ.make_cube_transform-Tuple{Vararg{BayesJ.Prior}}"><code>BayesJ.make_cube_transform</code></a></li><li><a href="#BayesJ.make_observation-Union{Tuple{T}, Tuple{A}, Tuple{Any, Any, Real, Tuple{var&quot;#s423&quot;, var&quot;#s423&quot;} where var&quot;#s423&quot;&lt;:Integer, A, Any, T, Any, Tuple{Real, Real}, Any}} where {A&lt;:(Union{Unitful.Quantity{T, ùêÄ, U}, Unitful.Level{L, S, Unitful.Quantity{T, ùêÄ, U}} where {L, S}} where {T, U}), T&lt;:(Union{Unitful.Quantity{T, ùêì, U}, Unitful.Level{L, S, Unitful.Quantity{T, ùêì, U}} where {L, S}} where {T, U})}"><code>BayesJ.make_observation</code></a></li><li><a href="#BayesJ.make_observation-Union{Tuple{T}, Tuple{A}, Tuple{Any, Any, Real, Tuple{var&quot;#s424&quot;, var&quot;#s424&quot;} where var&quot;#s424&quot;&lt;:Integer, A, Any, T, AbstractMatrix{&lt;:Union{Unitful.Quantity{T, ùêã^2, U}, Unitful.Level{L, S, Unitful.Quantity{T, ùêã^2, U}} where {L, S}} where {T, U}}, Tuple{var&quot;#s426&quot;, var&quot;#s426&quot;} where var&quot;#s426&quot;&lt;:(Union{Unitful.Quantity{T, ùêÄ, U}, Unitful.Level{L, S, Unitful.Quantity{T, ùêÄ, U}} where {L, S}} where {T, U}), Real}} where {A&lt;:(Union{Unitful.Quantity{T, ùêÄ, U}, Unitful.Level{L, S, Unitful.Quantity{T, ùêÄ, U}} where {L, S}} where {T, U}), T&lt;:(Union{Unitful.Quantity{T, ùêì, U}, Unitful.Level{L, S, Unitful.Quantity{T, ùêì, U}} where {L, S}} where {T, U})}"><code>BayesJ.make_observation</code></a></li><li><a href="#BayesJ.pixel_offset-Tuple{Any, Any, Any}"><code>BayesJ.pixel_offset</code></a></li><li><a href="#BayesJ.surface_brightness-Tuple{Union{Unitful.Quantity{T, ùêã, U}, Unitful.Level{L, S, Unitful.Quantity{T, ùêã, U}} where {L, S}} where {T, U}, Any, Any, Float64, Union{Unitful.Quantity{T, ùêã, U}, Unitful.Level{L, S, Unitful.Quantity{T, ùêã, U}} where {L, S}} where {T, U}, Function, Union{Unitful.Quantity{T, ùêÄ, U}, Unitful.Level{L, S, Unitful.Quantity{T, ùêÄ, U}} where {L, S}} where {T, U}, Vector{Float32}}"><code>BayesJ.surface_brightness</code></a></li><li><a href="#BayesJ.test_point-Tuple{BayesJ.Ellipse, Any, Any}"><code>BayesJ.test_point</code></a></li><li><a href="#BayesJ.transform-Tuple{BayesJ.Prior, Real}"><code>BayesJ.transform</code></a></li><li><a href="#BayesJ.œÅ_crit-Tuple{Any}"><code>BayesJ.œÅ_crit</code></a></li></ul><h2 id="Private-Interface"><a class="docs-heading-anchor" href="#Private-Interface">Private Interface</a><a id="Private-Interface-1"></a><a class="docs-heading-anchor-permalink" href="#Private-Interface" title="Permalink"></a></h2><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="BayesJ.cosmo" href="#BayesJ.cosmo"><code>BayesJ.cosmo</code></a> ‚Äî <span class="docstring-category">Constant</span></header><section><div><p>Cosmology assumed by BayesX</p><p>Defaults to:</p><ul><li>h=0.69,</li><li>Neff=3.04,</li><li>OmegaK=0,</li><li>OmegaM=0.29,</li><li>OmegaR=nothing,</li><li>Tcmb=2.7255,</li><li>w0=-1,</li><li>wa=0</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/Infinite-Improbability/BayesX-Julia/blob/ed20b39f0ea3dedfb489187e1d883568fa384f26/src/params.jl#L5-L17">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="BayesJ.Œº" href="#BayesJ.Œº"><code>BayesJ.Œº</code></a> ‚Äî <span class="docstring-category">Constant</span></header><section><div><p>Mean mass per gas particle = 0.6m‚Çö</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/Infinite-Improbability/BayesX-Julia/blob/ed20b39f0ea3dedfb489187e1d883568fa384f26/src/params.jl#L28">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="BayesJ.Œº_e" href="#BayesJ.Œº_e"><code>BayesJ.Œº_e</code></a> ‚Äî <span class="docstring-category">Constant</span></header><section><div><p>Mean gas mass per electron = 1.14m‚Çö</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/Infinite-Improbability/BayesX-Julia/blob/ed20b39f0ea3dedfb489187e1d883568fa384f26/src/params.jl#L31">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="BayesJ.Dataset" href="#BayesJ.Dataset"><code>BayesJ.Dataset</code></a> ‚Äî <span class="docstring-category">Type</span></header><section><div><p>Abstract type to wrap various specific formats for source data. By doing so we can make use of     multiple dispatch to automatically select the appropriate loading functions for data.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/Infinite-Improbability/BayesX-Julia/blob/ed20b39f0ea3dedfb489187e1d883568fa384f26/src/io.jl#L4-L7">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="BayesJ.Ellipse" href="#BayesJ.Ellipse"><code>BayesJ.Ellipse</code></a> ‚Äî <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia hljs">Ellipse(x, y, r1, r2, Œ∏)</code></pre><p>An ellipse centered at <code>(x, y)</code> with radii <code>r1</code> and <code>r2</code> and rotation <code>Œ∏</code>.</p><p><code>r1</code> and <code>r2</code> are the width and height respectively with zero rotation and <code>Œ∏</code> is defined as rotation counterclockwise from the x-axis in radians.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/Infinite-Improbability/BayesX-Julia/blob/ed20b39f0ea3dedfb489187e1d883568fa384f26/src/io.jl#L54-L61">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="BayesJ.LinearInterpolator" href="#BayesJ.LinearInterpolator"><code>BayesJ.LinearInterpolator</code></a> ‚Äî <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia hljs">LinearInterpolator(x, y)</code></pre><p>Construct a linear interpolator for the given data.</p><p><strong>Boundary behaviour</strong></p><p>If <code>x</code> is below the minimum value of <code>x</code> in the data it is rounded up the the minimum. This results in a flat line below the minimum value of <code>x</code>. In the cluster context this means the core properties may be constant below a certain radius. To avoid this simply fix the smallest value of <code>x</code>` at zero.</p><p>If <code>x</code> is above the maximum value of <code>x</code> in the data the interpolator returns zero. This is because the density and temperature are assumed to be zero outside the cluster. Fix the density and temperature at your largest radius to zero if you wish to avoid a discontinuity here.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/Infinite-Improbability/BayesX-Julia/blob/ed20b39f0ea3dedfb489187e1d883568fa384f26/src/cluster_models/model_piecewise.jl#L10-L25">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="BayesJ.ObservationError" href="#BayesJ.ObservationError"><code>BayesJ.ObservationError</code></a> ‚Äî <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia hljs">ObservationError(likelihood)</code></pre><p>This wraps a fallback likelihood value so it can be passed up the chain on an invalid prior combination.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/Infinite-Improbability/BayesX-Julia/blob/ed20b39f0ea3dedfb489187e1d883568fa384f26/src/emission.jl#L15-L20">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="BayesJ.Prior" href="#BayesJ.Prior"><code>BayesJ.Prior</code></a> ‚Äî <span class="docstring-category">Type</span></header><section><div><p>Abstract supertype for priors. Should implement:</p><ul><li>A transform(prior, x) function that transforms a value x on the unit range to a value on the distribution represented by the prior.</li><li>A field <code>name&lt;:AbstractString</code> </li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/Infinite-Improbability/BayesX-Julia/blob/ed20b39f0ea3dedfb489187e1d883568fa384f26/src/likelihood.jl#L56-L60">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="BayesJ.XS_Mekal" href="#BayesJ.XS_Mekal"><code>BayesJ.XS_Mekal</code></a> ‚Äî <span class="docstring-category">Type</span></header><section><div><p>Mekal model using SpectralFitting.jl framework. Kept around so we can borrow the model data downloading functions.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/Infinite-Improbability/BayesX-Julia/blob/ed20b39f0ea3dedfb489187e1d883568fa384f26/src/mekal.jl#L20">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="BayesJ.apply_response_function-Union{Tuple{T}, Tuple{Vector{T}, Matrix{T}, T}} where T&lt;:AbstractFloat" href="#BayesJ.apply_response_function-Union{Tuple{T}, Tuple{Vector{T}, Matrix{T}, T}} where T&lt;:AbstractFloat"><code>BayesJ.apply_response_function</code></a> ‚Äî <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">apply_response_function(counts_per_bin::Vector, response::Matrix, exposure_time::Unitful.Time)::Vector{Float64}</code></pre><p>Applies the response function <span>$RSP(PI, E) = RMF(PI, E) ‚àò ARF(E)$</span> to all energy bins and returns adjusted counts per bin.</p><p class="math-container">\[\begin{aligned}
C(PI) &amp;= T \int RMF(PI, E) ‚ãÖ ARF(E) ‚ãÖ S(E) ‚ãÖ dE \\
&amp;‚âà T \sum_{j} R_{ij} A_{j} S_{j}
\end{aligned}\]</p><p>with <code>C(PI)</code> is the observed counts in a detector channel <code>PI</code>, <code>T</code> is the observation time, <code>ARF(E)</code> is the effective area of the instrument and <code>RMF(E, PI)</code> [we use <code>RMF(PI, E)</code>] is the unitless response matrix. <code>S(E)</code> is the source flux, in [photon count]/[time]/[area]/[energy]. (Handbook of X-ray Astronomy Chapter 2011, Chapter 5 pg 87, by K. Arnaud, R. Smith and A. Siemiginowska)</p><p>This function takes the combined RMF and ARF as the response function. This is to recalculating it on every call. Some people format the RMF as RMF(E, PI), others as RMF(PI, E). This latter convention is used by CIAO and by us.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/Infinite-Improbability/BayesX-Julia/blob/ed20b39f0ea3dedfb489187e1d883568fa384f26/src/emission.jl#L110-L127">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="BayesJ.bin_events-Tuple{BayesJ.Dataset, Any, Vararg{Any}}" href="#BayesJ.bin_events-Tuple{BayesJ.Dataset, Any, Vararg{Any}}"><code>BayesJ.bin_events</code></a> ‚Äî <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">bin_events(::Dataset, events, ...)</code></pre><p>Placeholder function, returns events matrix without modification</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/Infinite-Improbability/BayesX-Julia/blob/ed20b39f0ea3dedfb489187e1d883568fa384f26/src/io.jl#L45-L48">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="BayesJ.bin_events-Tuple{FITSData, Any, Tuple{var&quot;#s1362&quot;, var&quot;#s1362&quot;} where var&quot;#s1362&quot;&lt;:Integer, Any, Any}" href="#BayesJ.bin_events-Tuple{FITSData, Any, Tuple{var&quot;#s1362&quot;, var&quot;#s1362&quot;} where var&quot;#s1362&quot;&lt;:Integer, Any, Any}"><code>BayesJ.bin_events</code></a> ‚Äî <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">bin_events(::FITSData, events, energy_range, x_edges, y_edges)</code></pre><p>Take a table of events in the format (x y channel), trim it by energy and bin it spatially. Returns an array of counts per bin with dimensions (channel, x, y).</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/Infinite-Improbability/BayesX-Julia/blob/ed20b39f0ea3dedfb489187e1d883568fa384f26/src/io/fits.jl#L380-L385">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="BayesJ.bin_events-Tuple{PlaintextData, Any, Vararg{Any}}" href="#BayesJ.bin_events-Tuple{PlaintextData, Any, Vararg{Any}}"><code>BayesJ.bin_events</code></a> ‚Äî <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">bin_events(::PlaintextData, events, ...)</code></pre><p>Placeholder function, returns events matrix without modification</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/Infinite-Improbability/BayesX-Julia/blob/ed20b39f0ea3dedfb489187e1d883568fa384f26/src/io/plaintext.jl#L61-L64">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="BayesJ.call_mekal-Union{Tuple{V}, Tuple{Vector{Float32}, Vector{Float32}, Integer, V, V, V, Float32, Float32}} where V&lt;:AbstractVector{Float32}" href="#BayesJ.call_mekal-Union{Tuple{V}, Tuple{Vector{Float32}, Vector{Float32}, Integer, V, V, V, Float32, Float32}} where V&lt;:AbstractVector{Float32}"><code>BayesJ.call_mekal</code></a> ‚Äî <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">call_mekal(n_energy_bins, abundances, min_energy, max_energy, bin_sizes, temperature, nH)</code></pre><p>Given a unitful range of energy and unitless temperature (keV) and hydrogen density in the source (cm^-3) calls MEKAL to calculate the volume emissivity of the source in the source frame.</p><p>Result is in photons/m^3/s/bin.</p><p>Metal abundances are set by <code>abundances</code>. They include H, He, C, N, O, Ne, Na, Mg, Al, Si, S, Ar, Ca, Fe and Ni and are specified with respect to solar values. MEKAL uses the solar values from (<a href="../references/#andersAbundancesElementsMeteoritic1989">Anders and Grevesse, 1989</a>).</p><p>Due to performance concerns I recommend calling <code>prepare_model_mekal</code> instead to generate an interpolation over the model. The functions returned by that wrapper also implicitly include absorption, which this function does not.</p><p><strong>Implementation Details</strong></p><p>The XSPEC and MEKAL documentation is at times short on detail. Here&#39;s what I&#39;ve figured out, mostly by inspecting the models in the XSPEC source code. The MEKA model has similar code and more extensive comments that MEKAL  that are very helpful.</p><p>The values calculated by MEKAL are multiplied by a constant of 2.53325e-3. Inspecting the MEKA comments we find the following equation for this constant which we will term <code>C</code></p><p class="math-container">\[C = ‚àö2 ‚ãÖ h^2 ‚ãÖ Œ±^3 / ((3œÄm_e)^1.5 ‚ãÖ ‚àö(1000e) ‚ãÖ œÄ ‚ãÖ (1pc)^2 ‚ãÖ 10^4)\]</p><p>and the instruction to use SI units. <code>h</code> appears to be Planck&#39;s constant (unreduced) and <code>Œ±</code> the fine-structure constant. Calculating this gives C=2.533242122484874e-59 kg^1/2 m^2 A^-1/2 s^-5/2.</p><p>MEKAL adjusts emissions by what it terms <code>cem</code> which is the emitting volume divided by the square of distance to the volume. This follows naturally from the relationship between surface emissivity <code>œÉ</code> and volume emissivity <code>œµ</code>.</p><p class="math-container">\[    œÉ = œµV / (4œÄD)^2\]</p><p>MEKAL uses units of 1e50cm^3 / 1pc^2 for <code>cem</code>. If we multiply by 10^50cm^3 we get 2.533242122484874e-13 J^2 cm s^2 C^-1/2 kg^-3/2. As dividing by 1pc^2 would change more than just the magnitude of the value I assume it is folded in as the 1pc^2 in the original equation. Furthermore I assume that remaining difference rests in the details of units and implementation.</p><p>MEKAL states it outputs in phot/cm^2/s/keV. MEKA states the same but has an optional switch that instead outputs in phot/m^3/s/keV. It does this by replacing <code>C</code> with <code>D=3.03103E-9</code> which it states is derived so that</p><p class="math-container">\[C = D * 10^40 / (4œÄ * 1pc^2)\]</p><p>I have verified this gives results matching that of doing the conversion manually (by dividing out 1e50cm^3 and multiplying by 1pc^2).</p><p>Attempts were made to invoke MEKAL through XSPEC&#39;s wrapper functions but I found the modifications they introduced were troublesome to work out, though some were necessary and are reimplemented in <code>surface_brightness</code>. MEKAL&#39;s operations are more clearly physically motivated.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/Infinite-Improbability/BayesX-Julia/blob/ed20b39f0ea3dedfb489187e1d883568fa384f26/src/mekal.jl#L52-L98">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="BayesJ.cluster" href="#BayesJ.cluster"><code>BayesJ.cluster</code></a> ‚Äî <span class="docstring-category">Function</span></header><section><div><p>Cluster pixels from blobs</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/Infinite-Improbability/BayesX-Julia/blob/ed20b39f0ea3dedfb489187e1d883568fa384f26/src/blobs.jl#L161">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="BayesJ.find_blobs_2D-Union{Tuple{T}, Tuple{AbstractMatrix{T}, T, Any, Any}} where T" href="#BayesJ.find_blobs_2D-Union{Tuple{T}, Tuple{AbstractMatrix{T}, T, Any, Any}} where T"><code>BayesJ.find_blobs_2D</code></a> ‚Äî <span class="docstring-category">Method</span></header><section><div><p>Find blobs in a 2D matrix</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/Infinite-Improbability/BayesX-Julia/blob/ed20b39f0ea3dedfb489187e1d883568fa384f26/src/blobs.jl#L8">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="BayesJ.fit_ellipse-Tuple{Matrix}" href="#BayesJ.fit_ellipse-Tuple{Matrix}"><code>BayesJ.fit_ellipse</code></a> ‚Äî <span class="docstring-category">Method</span></header><section><div><p>Fit an ellipse to a set of pixels</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/Infinite-Improbability/BayesX-Julia/blob/ed20b39f0ea3dedfb489187e1d883568fa384f26/src/blobs.jl#L91">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="BayesJ.getellipsepoints-Tuple{BayesJ.Ellipse}" href="#BayesJ.getellipsepoints-Tuple{BayesJ.Ellipse}"><code>BayesJ.getellipsepoints</code></a> ‚Äî <span class="docstring-category">Method</span></header><section><div><p>Get points from the boundry of the ellipse</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/Infinite-Improbability/BayesX-Julia/blob/ed20b39f0ea3dedfb489187e1d883568fa384f26/src/blobs.jl#L79">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="BayesJ.load_data-Tuple{BayesJ.Dataset}" href="#BayesJ.load_data-Tuple{BayesJ.Dataset}"><code>BayesJ.load_data</code></a> ‚Äî <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">load_data(data)</code></pre><p>Load events data from a given dataset, returning pairs of events and exposure times.</p><p>The first pair includes all observed events, the second is the background observation.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/Infinite-Improbability/BayesX-Julia/blob/ed20b39f0ea3dedfb489187e1d883568fa384f26/src/io.jl#L15-L21">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="BayesJ.load_data-Tuple{FITSData}" href="#BayesJ.load_data-Tuple{FITSData}"><code>BayesJ.load_data</code></a> ‚Äî <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">load_data(data::FITSData)</code></pre><p>Load data from FITS events files for the observation and background.</p><p>Exposure times are taken from the LIVETIME value in the header.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/Infinite-Improbability/BayesX-Julia/blob/ed20b39f0ea3dedfb489187e1d883568fa384f26/src/io/fits.jl#L82-L88">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="BayesJ.load_data-Tuple{PlaintextData}" href="#BayesJ.load_data-Tuple{PlaintextData}"><code>BayesJ.load_data</code></a> ‚Äî <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">load_data(data::PlaintextData)</code></pre><p>Load data from plaintext files as generated by existing Bayes-X binning scripts.</p><p>Data is reshaped to the given size so should be provided in column-major order or in a matrix of correct size.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/Infinite-Improbability/BayesX-Julia/blob/ed20b39f0ea3dedfb489187e1d883568fa384f26/src/io/plaintext.jl#L26-L33">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="BayesJ.load_events_from_fits-Tuple{AbstractString}" href="#BayesJ.load_events_from_fits-Tuple{AbstractString}"><code>BayesJ.load_events_from_fits</code></a> ‚Äî <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">load_events_from_fits(path)</code></pre><p>Loads events from a single fits file for further processing.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/Infinite-Improbability/BayesX-Julia/blob/ed20b39f0ea3dedfb489187e1d883568fa384f26/src/io/fits.jl#L41-L45">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="BayesJ.load_mask-Tuple{AbstractString, Any, Any}" href="#BayesJ.load_mask-Tuple{AbstractString, Any, Any}"><code>BayesJ.load_mask</code></a> ‚Äî <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">load_mask(path, x_edges, y_edges)</code></pre><p>Takes a mask file as used by DS9 and x and y edges to bin on. This should match the edges used to bin the data.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/Infinite-Improbability/BayesX-Julia/blob/ed20b39f0ea3dedfb489187e1d883568fa384f26/src/io.jl#L88-L93">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="BayesJ.load_mask-Tuple{BayesJ.Dataset}" href="#BayesJ.load_mask-Tuple{BayesJ.Dataset}"><code>BayesJ.load_mask</code></a> ‚Äî <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">load_mask(data)</code></pre><p>The matrix is true for masked pixels.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/Infinite-Improbability/BayesX-Julia/blob/ed20b39f0ea3dedfb489187e1d883568fa384f26/src/io.jl#L36-L40">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="BayesJ.load_response-Tuple{BayesJ.Dataset, Union{Unitful.Quantity{T, ùêã^2 ùêå ùêì^-2, U}, Unitful.Level{L, S, Unitful.Quantity{T, ùêã^2 ùêå ùêì^-2, U}} where {L, S}} where {T, U}, Union{Unitful.Quantity{T, ùêã^2 ùêå ùêì^-2, U}, Unitful.Level{L, S, Unitful.Quantity{T, ùêã^2 ùêå ùêì^-2, U}} where {L, S}} where {T, U}}" href="#BayesJ.load_response-Tuple{BayesJ.Dataset, Union{Unitful.Quantity{T, ùêã^2 ùêå ùêì^-2, U}, Unitful.Level{L, S, Unitful.Quantity{T, ùêã^2 ùêå ùêì^-2, U}} where {L, S}} where {T, U}, Union{Unitful.Quantity{T, ùêã^2 ùêå ùêì^-2, U}, Unitful.Level{L, S, Unitful.Quantity{T, ùêã^2 ùêå ùêì^-2, U}} where {L, S}} where {T, U}}"><code>BayesJ.load_response</code></a> ‚Äî <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">load_response(data, min_energy, max_energy)</code></pre><p>Load the RMF and ARF for an observation, trimmed for the desired energy range</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/Infinite-Improbability/BayesX-Julia/blob/ed20b39f0ea3dedfb489187e1d883568fa384f26/src/io.jl#L26-L30">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="BayesJ.load_response-Tuple{FITSData, Union{Unitful.Quantity{T, ùêã^2 ùêå ùêì^-2, U}, Unitful.Level{L, S, Unitful.Quantity{T, ùêã^2 ùêå ùêì^-2, U}} where {L, S}} where {T, U}, Union{Unitful.Quantity{T, ùêã^2 ùêå ùêì^-2, U}, Unitful.Level{L, S, Unitful.Quantity{T, ùêã^2 ùêå ùêì^-2, U}} where {L, S}} where {T, U}}" href="#BayesJ.load_response-Tuple{FITSData, Union{Unitful.Quantity{T, ùêã^2 ùêå ùêì^-2, U}, Unitful.Level{L, S, Unitful.Quantity{T, ùêã^2 ùêå ùêì^-2, U}} where {L, S}} where {T, U}, Union{Unitful.Quantity{T, ùêã^2 ùêå ùêì^-2, U}, Unitful.Level{L, S, Unitful.Quantity{T, ùêã^2 ùêå ùêì^-2, U}} where {L, S}} where {T, U}}"><code>BayesJ.load_response</code></a> ‚Äî <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">load_response(data::FITSData, min_energy::Unitful.Energy, max_energy::Unitful.Energy)</code></pre><p>Load response function for specified energy range, adjusting it to align with channel edges.</p><p>Returns response matrix, energy bins and included channels. Assumes the RMF and ARF are formatted according to the HEASARC OGIP Calibration Memo CAL/GEN/92-002</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/Infinite-Improbability/BayesX-Julia/blob/ed20b39f0ea3dedfb489187e1d883568fa384f26/src/io/fits.jl#L95-L102">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="BayesJ.load_response-Tuple{PlaintextData, Union{Unitful.Quantity{T, ùêã^2 ùêå ùêì^-2, U}, Unitful.Level{L, S, Unitful.Quantity{T, ùêã^2 ùêå ùêì^-2, U}} where {L, S}} where {T, U}, Union{Unitful.Quantity{T, ùêã^2 ùêå ùêì^-2, U}, Unitful.Level{L, S, Unitful.Quantity{T, ùêã^2 ùêå ùêì^-2, U}} where {L, S}} where {T, U}}" href="#BayesJ.load_response-Tuple{PlaintextData, Union{Unitful.Quantity{T, ùêã^2 ùêå ùêì^-2, U}, Unitful.Level{L, S, Unitful.Quantity{T, ùêã^2 ùêå ùêì^-2, U}} where {L, S}} where {T, U}, Union{Unitful.Quantity{T, ùêã^2 ùêå ùêì^-2, U}, Unitful.Level{L, S, Unitful.Quantity{T, ùêã^2 ùêå ùêì^-2, U}} where {L, S}} where {T, U}}"><code>BayesJ.load_response</code></a> ‚Äî <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">load_response(data::PlaintextData)</code></pre><p>Load response matrix from plaintext files as generated by existing Bayes-X binning scripts.</p><p>Data is reshaped to the given size so should be provided in column-major order or as a matrix of correct size.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/Infinite-Improbability/BayesX-Julia/blob/ed20b39f0ea3dedfb489187e1d883568fa384f26/src/io/plaintext.jl#L40-L47">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="BayesJ.log_factorial-Tuple{N} where N&lt;:Integer" href="#BayesJ.log_factorial-Tuple{N} where N&lt;:Integer"><code>BayesJ.log_factorial</code></a> ‚Äî <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">log_factorial(n)</code></pre><p>Finds <span>$\ln{n!}$</span> the natural logarithm of the factorial of <code>n</code>.</p><p>As Œì(n) = (n-1)! we can use SpecialFunctions.jl loggamma function to quickly calculate the log factorial.</p><p>It is intended to be broadcast across all values of the data array.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/Infinite-Improbability/BayesX-Julia/blob/ed20b39f0ea3dedfb489187e1d883568fa384f26/src/likelihood.jl#L45-L53">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="BayesJ.log_likelihood-Tuple{Any, Any, Any}" href="#BayesJ.log_likelihood-Tuple{Any, Any, Any}"><code>BayesJ.log_likelihood</code></a> ‚Äî <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">log_likelihood(observed, observed_background, predicted, predicted_background, observed_log_factorial)</code></pre><p>Calculate the log-likelihood of the prediction given an observation.</p><p>The observed and predicted arrays include background events.</p><p>The constant likelihood includes all parts of the likelihood that remain constant across observations. We require it to be supplied to improve performance - no need to calculate it every time.  It also includes the log factorial components calculated as <code>ln(observed) + ln(observed_background)</code>. As we haven&#39;t implemented support for background fitting on the user input side of things this includes the background.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/Infinite-Improbability/BayesX-Julia/blob/ed20b39f0ea3dedfb489187e1d883568fa384f26/src/likelihood.jl#L6-L17">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="BayesJ.make_cube_transform-Tuple{Vararg{BayesJ.Prior}}" href="#BayesJ.make_cube_transform-Tuple{Vararg{BayesJ.Prior}}"><code>BayesJ.make_cube_transform</code></a> ‚Äî <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">make_cube_transform(priors::Prior...)::NTuple{2, Function}</code></pre><p>Turn a sequence of prior transform functions into a transform function <code>transform_cube</code> that operates on the hypercube generated by multinest, stripping delta functions.</p><p>It also returns a function <code>reconstruct_args</code> take takes the output of the first function and returns it with the values of the delta priors inserted in appropriate postions.  This is because Ultranest can run with delta priors but outputs error warnings in the process.</p><p>Returns <code>transform_cube</code> and <code>reconstruct_args</code> as a tuple.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/Infinite-Improbability/BayesX-Julia/blob/ed20b39f0ea3dedfb489187e1d883568fa384f26/src/likelihood.jl#L190-L201">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="BayesJ.make_observation-Union{Tuple{T}, Tuple{A}, Tuple{Any, Any, Real, Tuple{var&quot;#s423&quot;, var&quot;#s423&quot;} where var&quot;#s423&quot;&lt;:Integer, A, Any, T, Any, Tuple{Real, Real}, Any}} where {A&lt;:(Union{Unitful.Quantity{T, ùêÄ, U}, Unitful.Level{L, S, Unitful.Quantity{T, ùêÄ, U}} where {L, S}} where {T, U}), T&lt;:(Union{Unitful.Quantity{T, ùêì, U}, Unitful.Level{L, S, Unitful.Quantity{T, ùêì, U}} where {L, S}} where {T, U})}" href="#BayesJ.make_observation-Union{Tuple{T}, Tuple{A}, Tuple{Any, Any, Real, Tuple{var&quot;#s423&quot;, var&quot;#s423&quot;} where var&quot;#s423&quot;&lt;:Integer, A, Any, T, Any, Tuple{Real, Real}, Any}} where {A&lt;:(Union{Unitful.Quantity{T, ùêÄ, U}, Unitful.Level{L, S, Unitful.Quantity{T, ùêÄ, U}} where {L, S}} where {T, U}), T&lt;:(Union{Unitful.Quantity{T, ùêì, U}, Unitful.Level{L, S, Unitful.Quantity{T, ùêì, U}} where {L, S}} where {T, U})}"><code>BayesJ.make_observation</code></a> ‚Äî <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">make_observation(temperature, density, z, shape, pixel_edge_angle, emission_model, exposure_time, response_function, centre, centre_radius, mask=nothing)</code></pre><p>Unitless wrapper for <a href="#BayesJ.make_observation-Union{Tuple{T}, Tuple{A}, Tuple{Any, Any, Real, Tuple{var&quot;#s423&quot;, var&quot;#s423&quot;} where var&quot;#s423&quot;&lt;:Integer, A, Any, T, Any, Tuple{Real, Real}, Any}} where {A&lt;:(Union{Unitful.Quantity{T, ùêÄ, U}, Unitful.Level{L, S, Unitful.Quantity{T, ùêÄ, U}} where {L, S}} where {T, U}), T&lt;:(Union{Unitful.Quantity{T, ùêì, U}, Unitful.Level{L, S, Unitful.Quantity{T, ùêì, U}} where {L, S}} where {T, U})}"><code>make_observation</code></a></p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/Infinite-Improbability/BayesX-Julia/blob/ed20b39f0ea3dedfb489187e1d883568fa384f26/src/emission.jl#L288-L292">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="BayesJ.make_observation-Union{Tuple{T}, Tuple{A}, Tuple{Any, Any, Real, Tuple{var&quot;#s424&quot;, var&quot;#s424&quot;} where var&quot;#s424&quot;&lt;:Integer, A, Any, T, AbstractMatrix{&lt;:Union{Unitful.Quantity{T, ùêã^2, U}, Unitful.Level{L, S, Unitful.Quantity{T, ùêã^2, U}} where {L, S}} where {T, U}}, Tuple{var&quot;#s426&quot;, var&quot;#s426&quot;} where var&quot;#s426&quot;&lt;:(Union{Unitful.Quantity{T, ùêÄ, U}, Unitful.Level{L, S, Unitful.Quantity{T, ùêÄ, U}} where {L, S}} where {T, U}), Real}} where {A&lt;:(Union{Unitful.Quantity{T, ùêÄ, U}, Unitful.Level{L, S, Unitful.Quantity{T, ùêÄ, U}} where {L, S}} where {T, U}), T&lt;:(Union{Unitful.Quantity{T, ùêì, U}, Unitful.Level{L, S, Unitful.Quantity{T, ùêì, U}} where {L, S}} where {T, U})}" href="#BayesJ.make_observation-Union{Tuple{T}, Tuple{A}, Tuple{Any, Any, Real, Tuple{var&quot;#s424&quot;, var&quot;#s424&quot;} where var&quot;#s424&quot;&lt;:Integer, A, Any, T, AbstractMatrix{&lt;:Union{Unitful.Quantity{T, ùêã^2, U}, Unitful.Level{L, S, Unitful.Quantity{T, ùêã^2, U}} where {L, S}} where {T, U}}, Tuple{var&quot;#s426&quot;, var&quot;#s426&quot;} where var&quot;#s426&quot;&lt;:(Union{Unitful.Quantity{T, ùêÄ, U}, Unitful.Level{L, S, Unitful.Quantity{T, ùêÄ, U}} where {L, S}} where {T, U}), Real}} where {A&lt;:(Union{Unitful.Quantity{T, ùêÄ, U}, Unitful.Level{L, S, Unitful.Quantity{T, ùêÄ, U}} where {L, S}} where {T, U}), T&lt;:(Union{Unitful.Quantity{T, ùêì, U}, Unitful.Level{L, S, Unitful.Quantity{T, ùêì, U}} where {L, S}} where {T, U})}"><code>BayesJ.make_observation</code></a> ‚Äî <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">make_observation(temperature, density, z, shape, pixel_edge_angle, emission_model, exposure_time, response_function, centre, centre_radius, mask=nothing, limit=10u&quot;Mpc&quot;)</code></pre><p>Generate an image of the cluster given functions for the radial profile of gas temperature and electron density and assorted observational parameters.</p><ul><li><code>shape</code> describes the size of the source number as a number of spatial bins in each dimension.-</li><li>The pixel edge angle describes the angular size observed by a single pixel in units such as arcseconds. This area is assumed to be square with the edge angle giving the side length.</li><li>The emission model should be a function compatible with the requirements of the <code>surface_brightness</code> function, which it will be passed to.</li><li>The response function includes both the RMF and ARF, as described in <a href="#BayesJ.apply_response_function-Union{Tuple{T}, Tuple{Vector{T}, Matrix{T}, T}} where T&lt;:AbstractFloat"><code>apply_response_function</code></a>.</li><li>The limit is passed through to <a href="#BayesJ.surface_brightness-Tuple{Union{Unitful.Quantity{T, ùêã, U}, Unitful.Level{L, S, Unitful.Quantity{T, ùêã, U}} where {L, S}} where {T, U}, Any, Any, Float64, Union{Unitful.Quantity{T, ùêã, U}, Unitful.Level{L, S, Unitful.Quantity{T, ùêã, U}} where {L, S}} where {T, U}, Function, Union{Unitful.Quantity{T, ùêÄ, U}, Unitful.Level{L, S, Unitful.Quantity{T, ùêÄ, U}} where {L, S}} where {T, U}, Vector{Float32}}"><code>surface_brightness</code></a></li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/Infinite-Improbability/BayesX-Julia/blob/ed20b39f0ea3dedfb489187e1d883568fa384f26/src/emission.jl#L181-L191">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="BayesJ.pixel_offset-Tuple{Any, Any, Any}" href="#BayesJ.pixel_offset-Tuple{Any, Any, Any}"><code>BayesJ.pixel_offset</code></a> ‚Äî <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">pixel_offset(ij, array_centre_indices, centre_offset_pixels)</code></pre><p>Calculate the distance from the centre of the cluster to the pixel at indices ij.</p><p>Result in pixels.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/Infinite-Improbability/BayesX-Julia/blob/ed20b39f0ea3dedfb489187e1d883568fa384f26/src/emission.jl#L169-L175">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="BayesJ.surface_brightness-Tuple{Union{Unitful.Quantity{T, ùêã, U}, Unitful.Level{L, S, Unitful.Quantity{T, ùêã, U}} where {L, S}} where {T, U}, Any, Any, Float64, Union{Unitful.Quantity{T, ùêã, U}, Unitful.Level{L, S, Unitful.Quantity{T, ùêã, U}} where {L, S}} where {T, U}, Function, Union{Unitful.Quantity{T, ùêÄ, U}, Unitful.Level{L, S, Unitful.Quantity{T, ùêÄ, U}} where {L, S}} where {T, U}, Vector{Float32}}" href="#BayesJ.surface_brightness-Tuple{Union{Unitful.Quantity{T, ùêã, U}, Unitful.Level{L, S, Unitful.Quantity{T, ùêã, U}} where {L, S}} where {T, U}, Any, Any, Float64, Union{Unitful.Quantity{T, ùêã, U}, Unitful.Level{L, S, Unitful.Quantity{T, ùêã, U}} where {L, S}} where {T, U}, Function, Union{Unitful.Quantity{T, ùêÄ, U}, Unitful.Level{L, S, Unitful.Quantity{T, ùêÄ, U}} where {L, S}} where {T, U}, Vector{Float32}}"><code>BayesJ.surface_brightness</code></a> ‚Äî <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">surface_brightness(projected_radius, temperature, density, z, limit, model, pixel_edge_angle)</code></pre><p>Calculate the observed surface_brightness at some projected radius on the sky.</p><p>The temperature and density functions should take the distance from origin (cluster centre) and return the appropriate value, with units.</p><p>The model should take these functions as input and return a vector of volume emissivities, where the vector element correspond with the energy bins used to generate the mode. It should include the effects of redshift on the bins and time dilation on the count rate.</p><p>The limit controls limits on LOS radius during integration. Testing suggests that Inf (default) is faster than finite values &gt;1. However finite values may avoid problems with models that are badly behaved at large radii.</p><p>The pixel edge angle is the angular size of a single pixel.</p><p>The result returned is the expected count rate per unit observing area, as a vector corresponding to the energy bins as used in the model.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/Infinite-Improbability/BayesX-Julia/blob/ed20b39f0ea3dedfb489187e1d883568fa384f26/src/emission.jl#L25-L41">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="BayesJ.test_point-Tuple{BayesJ.Ellipse, Any, Any}" href="#BayesJ.test_point-Tuple{BayesJ.Ellipse, Any, Any}"><code>BayesJ.test_point</code></a> ‚Äî <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">test_point(e::Ellipse, x, y; atol=0)</code></pre><p>Tests whether a point is within an ellipse with tolerance <code>atol</code>.</p><p>The equation for an ellipse in Cartesian coordinates is of the form <code>f(x,y) = 1</code>. We consider any point <code>(x0, y0)</code> such that <code>f(x0, y0) &lt;= 1 + atol</code> as being within the ellipse.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/Infinite-Improbability/BayesX-Julia/blob/ed20b39f0ea3dedfb489187e1d883568fa384f26/src/io.jl#L70-L77">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="BayesJ.transform-Tuple{BayesJ.Prior, Real}" href="#BayesJ.transform-Tuple{BayesJ.Prior, Real}"><code>BayesJ.transform</code></a> ‚Äî <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">transform(prior, x)</code></pre><p>Transforms a value x on the unit range to a value on the distribution represented by the prior.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/Infinite-Improbability/BayesX-Julia/blob/ed20b39f0ea3dedfb489187e1d883568fa384f26/src/likelihood.jl#L63-L67">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="BayesJ.œÅ_crit-Tuple{Any}" href="#BayesJ.œÅ_crit-Tuple{Any}"><code>BayesJ.œÅ_crit</code></a> ‚Äî <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">p_crit(z)</code></pre><p>Calculate the critical density at some redshift <code>z</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/Infinite-Improbability/BayesX-Julia/blob/ed20b39f0ea3dedfb489187e1d883568fa384f26/src/cluster_models.jl#L10-L14">source</a></section></article></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../public/">¬´ Public</a><a class="docs-footer-nextpage" href="../references/">References ¬ª</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="auto">Automatic (OS)</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.2.1 on <span class="colophon-date" title="Thursday 14 March 2024 02:19">Thursday 14 March 2024</span>. Using Julia version 1.9.4.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
